services:
  - type: web
    name: labor-management-system
    env: go
    plan: free
    buildCommand: |
      go version
      go mod download
      go mod verify
      mkdir -p bin
      CGO_ENABLED=1 GOOS=linux go build -a -installsuffix cgo -o bin/main cmd/server/main.go
      chmod +x start-render.sh
      ls -la bin/
      file bin/main
    startCommand: ./start-render.sh
    envVars:
      - key: PORT
        value: 10000
      - key: GIN_MODE
        value: release
      - key: DATABASE_URL
        fromDatabase:
          name: labor-management-db
          property: connectionString
      - key: JWT_SECRET
        generateValue: true
    autoDeploy: false
    
databases:
  - name: labor-management-db
    plan: free
    databaseName: labor_management
    user: labor_user 